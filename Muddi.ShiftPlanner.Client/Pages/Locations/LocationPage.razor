@page "/locations/{Id:guid}"
@using Muddi.ShiftPlanner.Client.Entities
@attribute [Authorize]
@if (_location is not null)
{
	<RadzenHeading Text="@_location.Name"/>

	<div class="checkbox-container" style="@(ShowOnlyUsersShifts ? "background: var(--muddi-red);color: white;" : "")">
		<RadzenCheckBox
			TValue="bool"
			@bind-Value="ShowOnlyUsersShifts"
			Change="UpdateQueryUri"
			Name="only-my-shift-check">
		</RadzenCheckBox>
		<RadzenLabel Text="Zeige nur meine Schichten" Component="only-my-shift-check" Style="margin-left: 8px; vertical-align: middle;"/>
	</div>

	<div style="position:relative;">
		@if (_isLoading && _enableLoadingSpinner)
		{
			<div class="" style="position: absolute;left: 0;top: 0;width: 100%; height:100%;background: #ffffff99;z-index: 10;backdrop-filter: blur(2px)">
				<div class="d-flex align-items-center flex-column mt-5">
					<LoadingSpinner/>
					<h3 style="color: var(--muddi-red)">MUDDI sucht Schichten...</h3>
				</div>
			</div>
		}
		<SwipeComponent OnSwipe="Swipe" Orientation="SwipeOrientation.Horizontal">
			<RadzenScheduler
				TItem="Appointment"
				style="height: 1000px;"
				@ref="_scheduler"
				SlotRender=@OnSlotRender
				Data=@Shifts
				LoadData="@LoadShifts"
				Date="StartDate"
				StartProperty="@nameof(Appointment.LocalStartTime)"
				EndProperty="@nameof(Appointment.LocalEndTime)"
				TextProperty="@nameof(Appointment.Title)"
				TodayText="Heute"
				SelectedIndex="@SelectedViewIndex"
				AppointmentRender=@OnAppointmentRender
				SlotSelect=@OnSlotSelect
				AppointmentSelect=@OnShiftSelect>

				<RadzenDayViewFix
					@ref="_dayView"
					TimeFormat="HH:mm"
					Text="Tag"
					StartTime="TimeSpan.FromHours(9)"
					EndTime="TimeSpan.FromHours(27)"
					MinutesPerSlot="30"/>
				<RadzenWeekView
					@ref="_weekView"
					Text="Woche"
					StartTime="TimeSpan.FromHours(9)"
					EndTime="TimeSpan.FromHours(27)"
					MinutesPerSlot="30"
					TimeFormat="HH:mm"/>
			</RadzenScheduler>
		</SwipeComponent>
	</div>
}